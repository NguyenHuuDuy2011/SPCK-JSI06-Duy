<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thông tin tài khoản</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
        integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="../css/info.css">
</head>

<body>
    <div class="container">
        <h1>Thông tin tài khoản</h1>
        <div class="account-info">
            <p><strong>Tên người dùng:</strong> <span id="username"></span></p>
            <p><strong>Thời gian đăng nhập:</strong> <span id="loginTime"></span></p>
        </div>
        <h2>Lịch sử làm bài</h2>
        <table id="history-table" class="history-table">
            <thead>
                <tr>
                    <th>Môn học</th>
                    <th>Điểm</th>
                    <th>Thời gian làm bài</th>
                </tr>
            </thead>
            <tbody>
                <!-- Lịch sử sẽ được thêm vào đây -->
            </tbody>
        </table>

        <button onclick="goBack()" class="btn-back"><i class="fa-solid fa-arrow-left"></i> Quay lại</button>
    </div>

    <script>
        // Lấy thông tin từ localStorage
        const username = localStorage.getItem("username");
        const loginTime = localStorage.getItem("loginTime");

        // Hiển thị thông tin tài khoản
        document.getElementById("username").innerText = username || "Không xác định";
        document.getElementById("loginTime").innerText = loginTime ? new Date(parseInt(loginTime)).toLocaleString() : "Không xác định";

        // Hàm quay lại trang trước
        function goBack() {
            window.history.back();
        }

        

        // Lấy lịch sử làm bài từ localStorage (hoặc Firestore nếu cần)
        // Lấy lịch sử làm bài từ localStorage
        // Tạo ánh xạ tên môn học từ tiếng Anh sang tiếng Việt
            const subjectMapping = {
                math: "Toán",
                history: "Lịch sử - Địa lí",
                IT: "Tin học",
                literature: "Ngữ văn"
            };

            // Lấy lịch sử làm bài từ localStorage
            const quizHistory = JSON.parse(localStorage.getItem("quizHistory")) || [];
            console.log("Lịch sử làm bài:", quizHistory);

            // Hiển thị lịch sử làm bài
            const historyTableBody = document.getElementById("history-table").querySelector("tbody");
            if (quizHistory.length === 0) {
                historyTableBody.innerHTML = "<tr><td colspan='3'>Không có lịch sử làm bài</td></tr>";
            } else {
               quizHistory.forEach((entry) => {
                    console.log("Mục lịch sử:", entry);
                    const row = document.createElement("tr");
                    row.innerHTML = `
        <td>${subjectMapping[entry.subject] || entry.subject}</td> <!-- Chuyển đổi tên môn học -->
        <td>${entry.score}</td> <!-- Hiển thị điểm số -->
        <td>${new Date(entry.timestamp).toLocaleString()}</td>
    `;
                    historyTableBody.appendChild(row);
                });
            }
    </script>
</body>

</html>